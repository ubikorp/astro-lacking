---
import { YouTube } from 'astro-embed';
import { Icon } from 'astro-icon/components';
import { getFormattedDate } from '~/utils/utils';
import { getPermalink } from '~/utils/permalinks';
import PostTags from '~/components/blog/Tags.astro';

import type { Post } from '~/types';

export interface Props {
  post: Post;
}

const { post } = Astro.props;

const video_url = post.video;
---

<div class="mt-2">
  <header>
    <div class="mb-1">
      <span class="text-sm">
        <Icon name="tabler:clock" class="w-3.5 h-3.5 inline-block -mt-0.5 dark:text-gray-400" />
        <time datetime={String(post.publishDate)} class="inline-block">{getFormattedDate(post.publishDate)}</time>
        {
          post.author && (
            <>
              {' '}
              · <Icon name="tabler:user" class="w-3.5 h-3.5 inline-block -mt-0.5 dark:text-gray-400" />
              <span>{post.author.replaceAll('-', ' ')}</span>
            </>
          )
        }
        {
          post.category && (
            <>
              {' '}
              ·{' '}
              <a class="hover:underline" href={getPermalink(post.category.slug, 'category')}>
                {post.category.title}
              </a>
            </>
          )
        }
      </span>
    </div>
    <h2 class="text-xl sm:text-2xl font-bold leading-tight mb-2 font-heading dark:text-slate-300" set:html={post.title} />
  </header>

  <div class="w-full text-center bg-neutral-100 dark:bg-slate-800 p-4 rounded-md shadow-md dark:shadow-none dark:border dark:border-slate-600">
    <YouTube id={video_url as string} class="mx-auto" />
    <div class="mt-2" set:html={post.caption} />
  </div>

  {
    post.tags && Array.isArray(post.tags) ? (
      <footer class="mt-5">
        <PostTags tags={post.tags} />
      </footer>
    ) : (
      <Fragment />
    )
  }
</div>

